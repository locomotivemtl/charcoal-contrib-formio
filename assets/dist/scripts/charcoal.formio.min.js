/*! @locomotivemtl/charcoal-contrib-formio 11-02-2019 */

!function(){var i=function(i){Charcoal.Admin.Property.call(this,i),this.set_properties(i).init()};(i.prototype=Object.create(Charcoal.Admin.Property.prototype)).constructor=Charcoal.Admin.Property_Input_Formio_Form,i.prototype.parent=Charcoal.Admin.Property.prototype,i.prototype.set_properties=function(i){return this._builder=void 0,this._builder_options=i.data.builder_options,this.save_action=i.save_action||"object/save",this.update_action=i.update_action||"object/update",this.$widget=this.element(),this.$builder=this.$widget.find(".js-form-builder"),this.$input=this.$widget.find(".js-input"),this.$loader=this.$widget.find(".js-loader"),this},i.prototype.init=function(){if(this.$loader.addClass("-is-loading"),"undefined"!=typeof Formio){var i=this.parse_options();this.init_builder(i)}else console.log("Missing formio.full.js dependencies")},i.prototype.parse_options=function(){return this._builder_options=$.extend(!0,{},this._builder_options),this._builder_options},i.prototype.init_builder=function(i){var t=this,o=this.$input.val()?JSON.parse(this.$input.val()):{};Formio.builder(this.$builder.get(0),o,{builder:i}).then(function(o){i.hasOwnProperty("submission")&&(o.submission=i.submission),t.$loader.removeClass("-is-loading"),t._builder=o})},i.prototype.save=function(){this.$input.val(JSON.stringify(this._builder.schema))},Charcoal.Admin.Property_Input_Formio_Form=i}(jQuery,document,Formio),function(){var i=function(i){Charcoal.Admin.Property.call(this,i),this.set_properties(i).init()};(i.prototype=Object.create(Charcoal.Admin.Property.prototype)).constructor=Charcoal.Admin.Property_Input_Formio_Schema,i.prototype.parent=Charcoal.Admin.Property.prototype,i.prototype.set_properties=function(i){return this._builder=void 0,this._builder_options=i.data.builder_options,this.$widget=this.element(),this.$builder=this.$widget.find(".js-form-builder"),this.$input=this.$widget.find(".js-input"),this.$loader=this.$widget.find(".js-loader"),this},i.prototype.init=function(){var i=this;if(this.$loader.addClass("-is-loading"),"undefined"!=typeof Formio){var t=this.parse_options();this.init_builder(t)}else $.getScript("https://cdn.jsdelivr.net/npm/formiojs@3.13.10/dist/formio.full.min.js").done(function(){i.init()})},i.prototype.parse_options=function(){return this._builder_options=$.extend(!0,{},this._builder_options),this._builder_options},i.prototype.init_builder=function(i){var t=this,o=this.$input.val()?JSON.parse(this.$input.val()):{};Formio.builder(this.$builder.get(0),o,{builder:i}).then(function(i){t.$loader.removeClass("-is-loading"),t._builder=i})},i.prototype.save=function(){this.$input.val(JSON.stringify(this._builder.schema))},Charcoal.Admin.Property_Input_Formio_Schema=i}(jQuery,document),function(){var i=function(i){Charcoal.Admin.Property.call(this,i),this.set_properties(i).init()};(i.prototype=Object.create(Charcoal.Admin.Property.prototype)).constructor=Charcoal.Admin.Property_Input_Formio_Submission,i.prototype.parent=Charcoal.Admin.Property.prototype,i.prototype.set_properties=function(i){return this._builder=void 0,this._builder_options=i.data.builder_options,this._schema=i.data.schema,this.save_action=i.save_action||"object/save",this.update_action=i.update_action||"object/update",this.$widget=this.element(),this.$builder=this.$widget.find(".js-form-builder"),this.$input=this.$widget.find(".js-input"),this.$loader=this.$widget.find(".js-loader"),this},i.prototype.init=function(){if(this.$loader.addClass("-is-loading"),"undefined"!=typeof Formio){var i=this.parse_options();this.init_builder(i)}else console.log("Missing formio.full.js dependencies")},i.prototype.parse_options=function(){return this._builder_options=$.extend(!0,{},this._builder_options),this._builder_options},i.prototype.init_builder=function(i){var t=this,o=this.$input.val()?JSON.parse(this.$input.val()):{};Formio.createForm(this.$builder.get(0),this._schema,i).then(function(i){null!==o&&(i.submission=o),t.$loader.removeClass("-is-loading"),t._builder=i})},i.prototype.save=function(){this.$input.val(JSON.stringify(this._builder.schema))},Charcoal.Admin.Property_Input_Formio_Submission=i}(jQuery,document,Formio);